<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Share Boost</title>
<style>
/* Global Styles */
body {
  margin: 0;
  padding: 0;
  font-family: Arial, sans-serif;
}

.wrapper-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  background: linear-gradient(135deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #8b00ff, #ff00ff);
  background-size: 700% 700%;
  animation: rainbowWave 10s ease infinite;
}

@keyframes rainbowWave {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

.container {
  background-color: rgba(255, 255, 255, 0.8);
  border-radius: 10px;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
  padding: 30px;
  margin: 20px auto;
  width: 80%;
  max-width: 800px;
}

.container h1 {
  color: #343a40;
  text-align: center;
  margin-bottom: 20px;
}

.container p {
  color: #343a40;
  margin-bottom: 20px;
}

.form-item {
  margin-bottom: 20px;
}

label {
  font-size: 16px;
  color: #495057;
  display: block;
  margin-bottom: 5px;
}

input, button {
  background: #fff;
  color: #000;
  border: solid 1px #222;
  box-sizing: border-box;
  width: 100%;
  padding: 15px;
  border-radius: 8px;
  font-size: 16px;
}

button {
  cursor: pointer;
  transition: background-color 0.3s ease;
}

button:hover {
  background-color: #ccc;
}

#process-container {
  display: block;
  background-color: rgba(255, 255, 255, 0.8);
  border-radius: 10px;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
  padding: 30px;
  margin: 20px auto;
  width: 80%;
  max-width: 800px;
}

#process-container h1 {
  color: #343a40;
  text-align: center;
  margin-bottom: 20px;
}

#processing {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.current-online {
  font-size: 13px;
  background: #ededed;
  padding: 10px;
  color: #0a0a0a;
  border: solid 1px #0a0a0a;
  border-radius: 4px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  margin-bottom: 10px;
  overflow: auto;
  white-space: nowrap;
}
</style>
</head>
<body>
<div class="wrapper-container">
  <div class="container">
    <h1>Welcome to Share Boost!</h1>
  </div>

  <div class="container">
    <h1>Share Post</h1>
    <form onsubmit="submitForm(event)" class="form-container">
      <div class="form-item">
        <label for="cookies">APPSTATE:</label>
        <input type="text" id="cookies" name="cookie" placeholder="Enter your app state" required>
      </div>
      <div class="form-item">
        <label for="urls">LINK:</label>
        <input type="url" id="urls" name="url" placeholder="Enter URL to share" required>
      </div>
      <div class="form-item">
        <label for="amounts">LIMIT:</label>
        <input type="number" id="amounts" name="amount" placeholder="Enter limit" required>
      </div>
      <div class="form-item">
        <label for="intervals">DELAY:</label>
        <input type="number" id="intervals" name="interval" placeholder="Enter delay" pattern="[0-9]*" required>
      </div>
      <div class="form-item">
        <button type="submit" id="submit-button">Submit</button>
      </div>
    </form>
  </div>

  <div id="process-container">
    <h1>Processing Links</h1>
    <div id="processing"></div>
  </div>

  <div class="container">
    <h1>About Us</h1>
    <p>Welcome to Share Boost! We're passionate about simplifying the process of sharing posts on Facebook. Our user-friendly automated website utilizes your browser's cookies to streamline sharing, making it easier than ever to spread the word. Join us in boosting your sharing experience today!</p>
  </div>
</div>

<script>
async function submitForm(event) {
  event.preventDefault();
  const button = document.getElementById('submit-button');
  const cookies = document.getElementById('cookies').value;
  const url = document.getElementById('urls').value;
  const amount = document.getElementById('amounts').value;
  const interval = document.getElementById('intervals').value;

  try {
    
    button.innerText = 'Submitting'; // Change button text to "Submitting"
    const response = await fetch('/api/submit', {
      method: 'POST',
      body: JSON.stringify({ cookie: cookies, url: url, amount: amount, interval: interval }),
      headers: { 'Content-Type': 'application/json' },
    });
    const data = await response.json();

    if (data.status === 200) {
      button.innerText = 'Submitted'; // Change button text to "Submitted" after successful submission
    } else {
      button.innerText = 'Submit'; // Change button text back to "Submit" if there's an error
    }
  } catch (e) {
    console.error(e);
  }
}

async function linkOfProcessing() {
  try {
    const container = document.getElementById('processing');
    const processContainer = document.getElementById('process-container');
    const initialResponse = await fetch('/total');

    if (!initialResponse.ok) {
      throw new Error(`Failed to fetch: ${initialResponse.status} - ${initialResponse.statusText}`);
    }

    const initialData = await initialResponse.json();
    if (initialData.length === 0) {
      processContainer.style.display = 'none';
      return;
    }
    initialData.forEach((link, index) => {

      let { url, count, id, target } = link;
      const processCard = document.createElement('div');
      processCard.classList.add('current-online');

      const text = document.createElement('h4');
      text.classList.add('count-text');
      text.innerHTML = `${index + 1}. ID: ${id} | ${count}/${target}`;

      processCard.appendChild(text);
      container.appendChild(processCard);

      const intervalId = setInterval(async () => {
        const updateResponse = await fetch('/total');

        if (!updateResponse.ok) {
          console.error(`Failed to fetch update: ${updateResponse.status} - ${updateResponse.statusText}`);
          return;
        }

        const updateData = await updateResponse.json();
        const updatedLink = updateData.find((link) => link.id === id);

        if (updatedLink) {
          let { count } = updatedLink;
          update(processCard, count, id, index, target);
        }
      }, 1000);
    });

  } catch (error) {
    console.error(error);
  }
}

function update(card, count, id, index, target) {
  let container = card.querySelector('.count-text');
  container.textContent = `${index + 1}. ID: ${id} | ${count}/${target}`;
}

linkOfProcessing();
</script>
</body>
</html>
